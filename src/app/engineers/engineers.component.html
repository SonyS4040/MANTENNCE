<div class="engineers-container">
  <h2>إدارة مهندسي الصيانة</h2>

  <div class="add-engineer-form">
    <h3>@if (editingEngineer()) { تعديل بيانات المهندس } @else { إضافة مهندس جديد }</h3>
    <form [formGroup]="engineerForm" (ngSubmit)="onSubmit()">
      <div class="form-group">
        <label for="name">اسم المهندس</label>
        <input type="text" id="name" formControlName="name" placeholder="أدخل اسم المهندس">
        @if (engineerForm.get('name')?.invalid && engineerForm.get('name')?.touched) {
          <div class="error">حقل الاسم مطلوب.</div>
        }
      </div>
      <div class="form-buttons">
        <button type="submit" class="submit-btn" [disabled]="isSubmitting || engineerForm.invalid">
          @if (isSubmitting) {
            <span>جاري الحفظ...</span>
          } @else {
            <span>@if(editingEngineer()){ حفظ التعديلات } @else { إضافة مهندس }</span>
          }
        </button>
        @if (editingEngineer()) {
          <button type="button" (click)="resetForm()" class="cancel-btn">إلغاء التعديل</button>
        }
      </div>
    </form>
  </div>

  <div class="engineers-list">
    <h3>قائمة المهندسين الحاليين</h3>
    @if (isLoading) {
      <p>جاري تحميل القائمة...</p>
    } @else if (error) {
      <div class="error-message">{{ error }}</div>
    } @else if (engineers().length === 0) {
      <p>لا يوجد مهندسون مسجلون حالياً.</p>
    } @else {
      <table>
        <thead>
          <tr>
            <th>اسم المهندس</th>
            <th>الإجراءات</th>
          </tr>
        </thead>
        <tbody>
          @for (engineer of engineers(); track engineer.id) {
            <tr>
              <td>{{ engineer.name }}</td>
              <td class="actions">
                <button (click)="startEdit(engineer)" class="edit-btn">تعديل</button>
                <button (click)="deleteEngineer(engineer.id, engineer.name)" class="delete-btn">حذف</button>
              </td>
            </tr>
          }
        </tbody>
      </table>
    }
  </div>
</div>