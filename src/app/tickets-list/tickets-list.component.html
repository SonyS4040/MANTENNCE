<div class="tickets-container">
  <h2>متابعة الأعطال</h2>
  
  @if (isLoading) {
    <p>جاري تحميل قائمة الأعطال...</p>
  } @else if (error) {
    <div class="error-message">
      <p>{{ error }}</p>
      <p>سيتم إضافة نظام تسجيل الدخول للموظفين قريباً.</p>
    </div>
  } @else if (tickets.length === 0) {
    <p>لا توجد أعطال مسجلة حالياً.</p>
  } @else {
    <div class="table-responsive">
      <table class="tickets-table">
        <thead>
          <tr>
            <th>الرقم المرجعي</th>
            <th>اسم العميل</th>
            <th>نوع الجهاز</th>
            <th>تاريخ الإنشاء</th>
            <th>الأولوية</th>
            <th>الحالة</th>
          </tr>
        </thead>
        <tbody>
          @for (ticket of tickets; track ticket.id) {
            <tr class="ticket-row-container">
              <td [routerLink]="['/tickets', ticket.id]">{{ ticket.ticket_ref }}</td>
              <td>
                <a [routerLink]="['/customers', ticket.customer_email]" class="customer-link">{{ ticket.customer_name }}</a>
              </td>
              <td [routerLink]="['/tickets', ticket.id]">{{ ticket.device_type }}</td>
              <td [routerLink]="['/tickets', ticket.id]">{{ ticket.created_at | date:'yyyy/MM/dd hh:mm a' }}</td>
              <td [routerLink]="['/tickets', ticket.id]">
                <span class="priority" [ngClass]="'priority-' + ticket.priority">{{ ticket.priority }}</span>
              </td>
              <td [routerLink]="['/tickets', ticket.id]">
                <span class="status" [ngClass]="'status-' + ticket.status">{{ ticket.status }}</span>
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  }
</div>