<div class="actions-grid">
  <div class="detail-section update-section">
    <h3>تحديث حالة العطل</h3>
    <form [formGroup]="statusUpdateForm" (ngSubmit)="updateTicketStatus()" class="status-form">
      <select formControlName="newStatus">
        @for(status of availableStatuses; track status) {
          <option [value]="status">{{ status }}</option>
        }
      </select>
      <button type="submit" [disabled]="isUpdatingStatus() || ticket.status === statusUpdateForm.value.newStatus">
        @if(isUpdatingStatus()) { <span>جاري التحديث...</span> } @else { <span>تحديث الحالة</span> }
      </button>
    </form>
  </div>

  <div class="detail-section update-section">
    <h3>تعيين مهندس</h3>
    <form [formGroup]="engineerAssignmentForm" (ngSubmit)="assignEngineer()" class="status-form">
      <select formControlName="engineerId">
        <option [ngValue]="null" disabled>اختر مهندساً...</option>
        @for(engineer of engineers(); track engineer.id) {
          <option [value]="engineer.id">{{ engineer.name }}</option>
        }
      </select>
      <button type="submit" [disabled]="isAssigningEngineer() || engineerAssignmentForm.invalid">
        @if(isAssigningEngineer()) { <span>جاري التعيين...</span> } @else { <span>تعيين</span> }
      </button>
    </form>
  </div>
</div>

<!-- New Video Upload Section -->
<div class="detail-section update-section video-upload-section">
  <h3>رفع فيديوهات الصيانة</h3>
  <p class="instructions">لرفع فيديو من واتساب، قم أولاً بحفظه على جهازك ثم اختره من هنا.</p>
  <div class="video-actions">
    <!-- Before Repair Video -->
    <div class="video-action-item">
      <h4>فيديو قبل الإصلاح</h4>
      <div class="form-group">
        <label for="before_repair_video">اختر ملف الفيديو</label>
        <input type="file" id="before_repair_video" (change)="onVideoChange($event, 'before')" accept="video/*">
      </div>
      <button (click)="uploadVideo('before')" [disabled]="!selectedVideos['before'] || isUploadingVideo['before']">
        @if(isUploadingVideo['before']) { <span>جاري الرفع...</span> } @else { <span>رفع الفيديو</span> }
      </button>
    </div>

    <!-- After Repair Video -->
    <div class="video-action-item">
      <h4>فيديو بعد الإصلاح</h4>
      <div class="form-group">
        <label for="after_repair_video">اختر ملف الفيديو</label>
        <input type="file" id="after_repair_video" (change)="onVideoChange($event, 'after')" accept="video/*">
      </div>
      <button (click)="uploadVideo('after')" [disabled]="!selectedVideos['after'] || isUploadingVideo['after']">
        @if(isUploadingVideo['after']) { <span>جاري الرفع...</span> } @else { <span>رفع الفيديو</span> }
      </button>
    </div>
  </div>
</div>